{% extends "base.html" %}

{% block body %}
<h1>{{ user.username }}'s Profile</h1>

<a href="{{ url_for('dashboard') }}">Back to Dashboard</a>

<h2>Lifetime Statistics</h2>
{% if stats.games_played %}
    <table>
        <tr><td><strong>Games Played:</strong></td><td>{{ stats.games_played }}</td></tr>
        <tr><td><strong>Total Points:</strong></td><td>{{ stats.total_points or 0 }}</td></tr>
        <tr><td><strong>Total Rebounds:</strong></td><td>{{ stats.total_rebounds or 0 }}</td></tr>
        <tr><td><strong>Total Assists:</strong></td><td>{{ stats.total_assists or 0 }}</td></tr>
        <tr><td><strong>Average Points:</strong></td><td>{{ "%.1f"|format(stats.avg_points or 0) }}</td></tr>
        <tr><td><strong>Average Rebounds:</strong></td><td>{{ "%.1f"|format(stats.avg_rebounds or 0) }}</td></tr>
        <tr><td><strong>Average Assists:</strong></td><td>{{ "%.1f"|format(stats.avg_assists or 0) }}</td></tr>
    </table>
{% else %}
    <p>No game statistics available yet.</p>
{% endif %}

<h2>Player Rating</h2>
{% if ratings.total_ratings %}
    <table>
        <tr><td><strong>Total Ratings Received:</strong></td><td>{{ ratings.total_ratings }}</td></tr>
        <tr><td><strong>Average Rating:</strong></td><td>{{ "%.2f"|format(ratings.avg_rating) }}/5</td></tr>
    </table>
{% else %}
    <p>No ratings received yet.</p>
{% endif %}

<h2>Recent Games</h2>
{% if recent_games %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Court</th>
                <th>Points</th>
                <th>Rebounds</th>
                <th>Assists</th>
            </tr>
        </thead>
        <tbody>
            {% for game, stats in recent_games %}
            <tr>
                <td>{{ game.time.strftime('%Y-%m-%d') }}</td>
                <td>{{ game.court.name }}</td>
                <td>{{ stats.points }}</td>
                <td>{{ stats.rebounds }}</td>
                <td>{{ stats.assists }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No recent games with stats available.</p>
{% endif %}

<h2>Recent Ratings Received</h2>
{% if recent_ratings %}
    <table>
        <thead>
            <tr>
                <th>From Player</th>
                <th>Rating</th>
                <th>Comment</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for rating, from_user in recent_ratings %}
            <tr>
                <td>{{ from_user.username }}</td>
                <td>{{ rating.rating }}/5</td>
                <td>{{ rating.comment if rating.comment else '-' }}</td>
                <td>{{ rating.created_at.strftime('%Y-%m-%d') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>No ratings received yet.</p>
{% endif %}

{% endblock %}